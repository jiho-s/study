## 영속성

### 파일 시스템

Kafka는 메시지 저장 및 캐싱을 위해 파일 시스템을 사용한다. 잘 설계된 디스크 구조는 네트워크만큼 빠를 수 있다.

카프카는 JVM을 기반으로 구축되어 있으며 자바의 메모리는 다음과 같은 단점이 있다.

1. 객체의 메모리 오버 헤드는 매우 크며, 데이터의 크기가 두배가 되는 경우가 많다.
2. 힙 데이터가 증가하면 Java 가비지 콜렉션은 더 어렵고 느려진다.

이러한 이유로 파일 시스템을 사용하고 페이지 캐시에 의존하는 것이 인메모리 캐시 또는 기타 구조를 사용하는 것보다 효율적이다. 파일 시스템을 사용하여 사용 가능한 캐시를 최소 두배로 늘릴 수 도 있다.

### 상수 시간 탐색

스토리지 시스템이 캐시 연산과 매우 느린 디스크 연산을 혼합하므로서 캐시가 고정되었을 때 데이터가 증가하면 성능이 느려진다.

영속성 큐는 로깅의 일반적인 경우와 같이 간단한 읽거나 파일에 추가할 수 있다. 작업의 시간 복잡도가 O(1)이고 읽기 쓰기가 서로의 작업을 블록하지 않는다는 장점이 있다.

