## 소개

### 이벤트 스트리밍이란

이벤트 스트리밍은 데이터베이스, 센서, 모바일 장치, 클라우드 서비스 및 소프트웨어 애플리케이션과 같은 이벤트 소스에서 이벤트 스트림 형태로 실시간으로 데이터를 캡처하는 기능이다. 검색할 수 있도록 이러한 지속적으로 저장하고, 실시간으로 조작 처리 및 반응하고, 필요에 따라 이벤트 스트림을 다른 대상으로 라우팅한다. 따라서 이벤트 스트리밍은 데이터의 지속적인 흐름과 해석을 보장하여 적절한 정보가 적절한 장소에 적절한 시간에 제공되도록한다.

### 이벤트 스트리밍을 사용할수 있는 곳

- 증권 거래소, 은행, 보험 등에서 실시간으로 결제 및 금융 거래를 처리
- 물류 및 자동차 산업과 같이 실시간으로 자동차 트럭 차량 및 배송을 추적
- 공장 및 풍력 단지와 같은 IoT 장치 또는 기타 장비에서 센서 데이터를 지속적으로 캡처하고 분석
- 소매 호텔 및 여행 산업, 모바일 애플리케이션과 같은 고객 상호 작용 및 주문을 접수하고 즉시 대응
- 병원 치료에서 환자를 모니터링하고 상태 변화를 예측하여 응급 상황에서 적시에 치료
- 회사의 여러부서에 생성된 데이터를 연결 저장 및 사용
- 데이터 플랫폼, 이벤트 기반 아키텍처 및 마이크로 서비스의 기반

### Apache Kafka

1. 다른 시스템에서 데이터의 지속적인 가져오기 / 내보내기를 포함하여 이벤트 스트림을 **publish**하고 **subscribe** 한다
2. 원하는 기간 동안 지속적이고 안정적으로 이벤트 스트림을 **저장** 한다.
3. 이벤트가 발생했을 때 이를 **처리**

이 모든 기능은 분산되고 확장성이 뛰어나며, 탄력적이며, 내결함성이 있으며 안전한 방식으로 제공된다.

### Kafka의 작동방식

Kafka는 TCP 네트워크 프로토콜을 통해 통신하는 서버와 클라이언트로 구성된 분산 시스템이다.

#### 서버

Kafka는 여러 데이터 센터 또는 클라우드 지역에 있을수 있는 하나 이상의 서버 클러스토로 실행된다. 이러한 서버 중 브로커라고 하며 스토리지 계층을 형성한다. 다른 서버는 Kafka Conneect를 실행하여 데이터를 이벤트 스트림으로 지속적으로 가져오고 내 보내어 관계형 데이터 베이스 및  다른 Kafka 클러스터와 같은 기존의 시스템과 통합한다. Kafka 클라스터는 확장성이 뛰어나고 내결함성이 있다. 서버 중 하나가 실패하면, 다른 서버가 데이터 손실없이 지속적인 운영을 보장하기 위해 작업을 대신한다.

#### 클라이언트

네트워크 문제 또는 시스템 장애의 경우에도 이벤트의 스트림을 병렬, 스케일, 내결함성 방식으로 읽고 쓰고 처리하는 마이크로 서비스를 작성할 수 있다.

### 주요 개념 및 용어

#### 이벤트

레코드또는 메시지로 Kafka에서 데이터를 읽거나 쓸때 이벤트 형태로 수행한다. 이벤트에는 키, 값, 타임스탬프 및 메타데이터 헤더가 있다.

#### Producer

Kafka에서 이벤트를 쓰기하는 클라이언트 애플리케이션

#### Consumers

이러한 이벤트를 구독하는 클라이언트

Kafka에서 생산자와 소비자는 완전히 분리되어 있다. 생산자는 소비자를 기다릴 필요가 없다

#### Topic

이벤트는 토픽에 구성되고 지속적으로 저장된다. 단순화 하자면, 토픽은 파일 시스템의 폴더와 유사하며, 이벤트는 해당 폴더의 파일이다. Kafka의 토픽은 항상 여러개의 생산자와 여러개의 구독자를 가지고 있다. 기존 메시징 시스템과 달리 이벤트는 소비 후 삭제ㅐ되지 않는다. 대신 Kafka가 토픽별 설정을 통해 이벤트를 유지해야하는 기간을 정의한 후 이전 이벤트가 삭제된다. 

토픽은 분할되어 있다. 토픽이 서로 다른 Kafka 브로커에 있는 여러 버킷에 분산되어 있다. 클라이언트 애플리케이션이 동시에 여러 브로커에서 데이터를 읽고 쓸 수 있도록한다. 새 이벤트가 토픽에 게시되면 토픽에 파티션 중 하나에 추가된다. 동일한 이벤트 키를 가진 이벤트는 동일한 파티션에 기록되고 Kafka는 지정된 주제 파티션의 소비자가 항상 기록된 것과 동일한 순서로 해당 파티션의 이벤트를 읽도록 보장한다.

데이터 내 결함 및 가용성을 높이기 위해 모든 토픽을 지역 또는 데이터 센터를 넘어 복제할 수 있으므로 데이터 사본을 보유한 여러 브로커가 항상 존제한다. 일반적으로 복제 요소는 3개가 존제한다. 복제는 토픽 파티션 수준에서 실행된다.